[
  {
    "name": "ls_command",
    "description": "디렉토리의 파일 및 폴더 목록을 보여줍니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "ls {options} {path}",
    "preconditions": {
        "shell_access": true
    },
    "effects": {
        "target": true
    },
    "available_options": {
        "-a": "숨김 파일을 포함한 모든 항목을 보여줍니다.",
        "-l": "자세한 정보(권한, 소유자 등)를 함께 보여줍니다."
    },
    "parser_info": {
      "type": "rule_based",
      "target_field": "file_system.known_files",
      "target_identifier_from": "path"
    }
  },
  {
    "name": "cat_command",
    "description": "파일의 내용을 출력합니다.",
    "command_template": "cat {filepath}",
    "preconditions": { "shell_access": true, "target": true },
    "effects": { "file_content_read": true },
    "parser_info": {
      "type": "llm_based",
      "prompt_template": "다음 파일 내용을 분석하여 보안상 중요한 정보(패스워드, 설정, 취약점 등)를 추출하고 요약해주세요."
    }
  },
  {
    "name": "cut_command",
    "description": "입력에서 특정 구분자로 필드를 잘라냅니다.",
    "command_template": "cut -d '{delimiter}' -f {field_number}",
    "preconditions": { "shell_access": true, "pattern_filtered": true },
    "effects": { "final_data_extracted": true },
    "parser_info": {
      "type": "rule_based",
      "target_field": "extracted_data.cut_results"
    }
  },
  {
    "name": "find_command",
    "description": "파일 시스템에서 특정 조건의 파일을 검색합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "find {path} -name '{filename}'",
    "preconditions": { "shell_access": true },
    "effects": { "target": true },
    "parser_info": {
      "type": "rule_based",
      "target_field": "file_system.found_files",
      "target_identifier_from": "path"
    }
  },
  {
    "name": "grep_command",
    "description": "파일 내용이나 다른 출력에서 특정 패턴을 검색합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "grep {options} '{pattern}'",
    "preconditions": { "shell_access": true, "file_content_read": true },
    "effects": { "found_keyword": true, "pattern_filtered": true },
    "available_options": {
      "-i": "대소문자를 무시합니다.",
      "-r": "하위 디렉토리까지 재귀적으로 검색합니다."
    },
    "parser_info": {
      "type": "rule_based",
      "target_field": "search_results.grep_matches"
    }
  },
  {
    "name": "file_command",
    "description": "파일의 종류(타입)를 식별합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "file {filepath}",
    "preconditions": { "shell_access": true, "target": true },
    "effects": { "file_type_identified": true },
    "parser_info": {
      "type": "rule_based",
      "target_field": "file_system.file_types"
    }
  },
  {
    "name": "strings_command",
    "description": "바이너리 파일을 포함한 모든 파일에서 문자열을 추출합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "strings {options} {filepath}",
    "preconditions": { "shell_access": true, "target": true },
    "effects": { "strings_extracted": true },
    "available_options": {
      "-n 10": "최소 10글자 이상인 문자열만 추출합니다."
    },
    "parser_info": {
      "type": "llm_based",
      "prompt_template": "다음 strings 명령어 출력에서 보안상 중요한 문자열(패스워드, URL, 경로, 함수명 등)을 식별하고 분석해주세요."
    }
  },
  {
    "name": "base64_decode_command",
    "description": "Base64로 인코딩된 내용을 디코딩합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "base64 -d {filepath}",
    "preconditions": { "shell_access": true, "target": true },
    "effects": { "file_decoded": true },
    "parser_info": {
      "type": "llm_based",
      "prompt_template": "다음 Base64 디코딩 결과를 분석하여 중요한 정보나 보안 관련 내용을 추출해주세요."
    }
  },
  {
    "name": "unzip_command",
    "description": ".zip 확장자 압축 파일을 해제합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "unzip -o {filepath}",
    "preconditions": { "shell_access": true, "target": true },
    "effects": { "archive_extracted": true },
    "parser_info": {
      "type": "rule_based",
      "target_field": "file_system.extracted_files"
    }
  },
  {
    "name": "tar_extract_command",
    "description": ".tar 또는 .tar.gz 압축 파일을 해제합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "tar xvf {filepath}",
    "preconditions": { "shell_access": true, "target": true },
    "effects": { "archive_extracted": true },
    "parser_info": {
      "type": "rule_based",
      "target_field": "file_system.extracted_files"
    }
  },
  {
    "name": "gunzip_command",
    "description": ".gz 확장자 압축 파일을 해제합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "gunzip {filepath}",
    "preconditions": { "shell_access": true, "target": true },
    "effects": { "archive_extracted": true },
    "parser_info": {
      "type": "rule_based",
      "target_field": "file_system.extracted_files"
    }
  },
  {
    "name": "nmap_command",
    "description": "네트워크 스캔을 통해 포트, 서비스, 버전 정보 등을 확인합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "nmap {options} {target_ip}",
    "preconditions": { "target_ip_known": true },
    "effects": { "port_info_known": true, "service_version_known": true },
    "parser_info": {
      "type": "regex_based",
      "target_identifier_from": "target_ip",
      "patterns": [
        {
          "regex": "(\\d+)/(tcp|udp)\\s+(open|closed|filtered)\\s+(\\w+)\\s*(.*)$",
          "target_field": "network_services",
          "mapping": {
            "port": 1,
            "protocol": 2,
            "state": 3,
            "service": 4,
            "version": 5
          }
        }
      ]
    }
  },
  {
    "name": "gobuster_dir_command",
    "description": "웹사이트의 디렉토리 및 파일을 브루트포싱하여 찾습니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "gobuster dir -u {target_url} -w {wordlist_path}",
    "preconditions": { "target_url_known": true, "wordlist_available": true },
    "effects": { "web_dirs_found": true },
    "parser_info": {
      "type": "regex_based",
      "patterns": [
        {
          "regex": "(/[^\\s]+)\\s+\\(Status:\\s*(\\d+)\\)\\s*\\[Size:\\s*(\\d+)\\]",
          "target_field": "web_applications.directories",
          "mapping": {
            "path": 1,
            "status_code": 2,
            "size": 3
          }
        }
      ]
    }
  },
  {
    "name": "searchsploit_command",
    "description": "서비스나 버전에 대한 공개된 취약점(Exploit-DB)을 검색합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "searchsploit {keyword}",
    "preconditions": { "shell_access": true, "service_version_known": true },
    "effects": { "exploit_code_found": true },
    "parser_info": {
      "type": "regex_based",
      "patterns": [
        {
          "regex": "([^|]+)\\s*\\|\\s*([^|]+)\\s*\\|\\s*([^|]+)$",
          "target_field": "vulnerabilities.exploits",
          "mapping": {
            "exploit_name": 1,
            "platform": 2,
            "exploit_db_id": 3
          }
        }
      ]
    }
  },
  {
    "name": "john_command",
    "description": "John the Ripper를 사용해 패스워드 해시를 크래킹합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "john {options} {hash_file_path}",
    "preconditions": { "shell_access": true, "target": true },
    "effects": { "password_cracked": true },
    "parser_info": {
      "type": "regex_based",
      "patterns": [
        {
          "regex": "([^\\s:]+)\\s*:\\s*([^\\s]+)",
          "target_field": "credentials.cracked_passwords",
          "mapping": {
            "username": 1,
            "password": 2
          }
        }
      ]
    }
  },
  {
    "name": "exiftool_command",
    "description": "파일의 메타데이터(EXIF)를 읽습니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "exiftool {filepath}",
    "preconditions": { "shell_access": true, "target": true },
    "effects": { "metadata_extracted": true },
    "parser_info": {
      "type": "llm_based",
      "prompt_template": "다음 EXIF 메타데이터에서 보안상 중요한 정보(GPS 좌표, 카메라 정보, 소프트웨어 버전 등)를 추출하고 분석해주세요."
    }
  },
  {
    "name": "netcat_listen_command",
    "description": "Netcat을 이용해 특정 포트에서 연결을 기다립니다 (리스닝).",
    "base_block_type": "generic_shell_command",
    "command_template": "nc -lvnp {port}",
    "preconditions": { "shell_access": true },
    "effects": { "listening_on_port": true },
    "parser_info": {
      "type": "rule_based",
      "target_field": "network_services.listening_ports"
    }
  },
  {
    "name": "linenum_command",
    "description": "LinEnum 스크립트를 실행하여 권한 상승 정보를 자동 검색합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "./LinEnum.sh {options}",
    "preconditions": { "shell_access": true, "target": true },
    "effects": { "privesc_info_gathered": true },
    "parser_info": {
      "type": "llm_based",
      "prompt_template": "다음 LinEnum 스크립트 출력에서 권한 상승에 사용할 수 있는 취약점이나 중요한 정보를 식별하고 우선순위를 매겨 분석해주세요."
    }
  },
  {
    "name": "sherlock_command",
    "description": "사용자 이름으로 여러 소셜 미디어에서 계정을 검색합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "python3 sherlock.py {username}",
    "preconditions": { "shell_access": true, "sherlock_installed": true },
    "effects": { "sns_accounts_found": true },
    "parser_info": {
      "type": "regex_based",
      "patterns": [
        {
          "regex": "\\[\\+\\]\\s*([^:]+):\\s*(https?://[^\\s]+)",
          "target_field": "osint.social_media_accounts",
          "mapping": {
            "platform": 1,
            "url": 2
          }
        }
      ]
    }
  },
  {
    "name": "pipe_command",
    "description": "이전 명령어의 출력을 다음 명령어의 입력으로 전달하는 파이프 역할을 합니다.",
    "preconditions": { "shell_access": true },
    "effects": {},
    "parser_info": {
      "type": "rule_based",
      "target_field": "command_flow.pipe_data"
    }
  },
  {
    "name": "ps_command",
    "description": "실행 중인 프로세스 목록을 확인합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "ps {options}",
    "preconditions": { "shell_access": true },
    "effects": { "process_info_known": true },
    "available_options": {
      "aux": "모든 프로세스의 상세 정보를 표시합니다.",
      "-ef": "모든 프로세스를 풀 포맷으로 표시합니다."
    },
    "parser_info": {
      "type": "regex_based",
      "patterns": [
        {
          "regex": "([^\\s]+)\\s+(\\d+)\\s+([^\\s]+)\\s+([^\\s]+)\\s+([^\\s]+)\\s+([^\\s]+)\\s+([^\\s]+)\\s+([^\\s]+)\\s+(.+)$",
          "target_field": "system_info.processes",
          "mapping": {
            "user": 1,
            "pid": 2,
            "cpu": 3,
            "memory": 4,
            "vsz": 5,
            "rss": 6,
            "tty": 7,
            "stat": 8,
            "command": 9
          }
        }
      ]
    }
  },
  {
    "name": "netstat_command",
    "description": "네트워크 연결 상태와 포트 정보를 확인합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "netstat {options}",
    "preconditions": { "shell_access": true },
    "effects": { "network_connections_known": true },
    "available_options": {
      "-tulpn": "TCP/UDP 포트의 리스닝 상태와 프로세스 정보를 표시합니다.",
      "-an": "모든 연결과 리스닝 포트를 숫자로 표시합니다."
    },
    "parser_info": {
      "type": "regex_based",
      "patterns": [
        {
          "regex": "(tcp|udp)\\s+(\\d+)\\s+(\\d+)\\s+([^\\s]+)\\s+([^\\s]+)\\s+(\\w+)\\s*(.*)$",
          "target_field": "network_services.connections",
          "mapping": {
            "protocol": 1,
            "recv_q": 2,
            "send_q": 3,
            "local_address": 4,
            "foreign_address": 5,
            "state": 6,
            "process": 7
          }
        }
      ]
    }
  },
  {
    "name": "whoami_command",
    "description": "현재 사용자의 이름을 확인합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "whoami",
    "preconditions": { "shell_access": true },
    "effects": { "current_user_known": true },
    "parser_info": {
      "type": "rule_based",
      "target_field": "system_info.current_user"
    }
  },
  {
    "name": "id_command",
    "description": "현재 사용자의 ID와 그룹 정보를 확인합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "id {username}",
    "preconditions": { "shell_access": true },
    "effects": { "user_privileges_known": true },
    "parser_info": {
      "type": "regex_based",
      "patterns": [
        {
          "regex": "uid=(\\d+)\\(([^)]+)\\)\\s+gid=(\\d+)\\(([^)]+)\\)\\s+groups=(.+)$",
          "target_field": "users_and_groups.user_info",
          "mapping": {
            "uid": 1,
            "username": 2,
            "gid": 3,
            "groupname": 4,
            "groups": 5
          }
        }
      ]
    }
  }
]