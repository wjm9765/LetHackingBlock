
[
  {
    "name": "ls_command",
    "description": "디렉토리의 파일 및 폴더 목록을 보여줍니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "ls {options} {path}",
    "preconditions": { "shell_access": true },
    "effects": { "target": true },
    "available_options": {
        "-a": "숨김 파일을 포함한 모든 항목을 보여줍니다.",
        "-l": "자세한 정보(권한, 소유자 등)를 함께 보여줍니다."
    },
    "parser_info": {
      "type": "llm_based",
      "target_field": "knowledge_base.known_facts",
      "prompt_template": "다음은 ls 명령어의 결과입니다. 해킹 관점에서 유용한 모든 정보를 우선순위 순으로 정리해주세요. 각 파일/디렉토리에 대해 파일명, 권한, 소유자, 크기, 날짜 등 모든 정보를 포함하여 정리해주세요.(원본 파일에 없으면 생략 가능) 우선순위가 높은 것부터 나열하되, 원본 데이터의 모든 내용이 포함되어야 합니다. 정보 이외에 불필요한 대답은 하지 마세요. 그리고 대답 토큰을 줄이기 위해 불필요한 기호나, 숫자, 문자를 사용하지 마세요"
    }
  },
  {
    "name": "cat_command",
    "description": "파일의 내용을 출력합니다.",
    "command_template": "cat {filepath}",
    "preconditions": { "shell_access": true, "target": true },
    "effects": { "file_content_read": true },
    "parser_info": {
      "type": "llm_based",
      "target_field": "knowledge_base.known_facts",
      "prompt_template": "다음 파일 내용에서 해킹에 유용할 수 있는 정보(예: 비밀번호, 설정 오류, 사용자 이름, 숨겨진 경로 등)를 분석하고 요약해줘. 그 정보를 한줄씩 나열해줘, 정보 이외에 불필요한 대답은 하지마"
    }
  },
  {
    "name": "nmap_command",
    "description": "네트워크 스캔을 통해 포트, 서비스, 버전 정보 등을 확인합니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "nmap {options} {target_ip}",
    "preconditions": { "target_ip_known": true },
    "effects": { "port_info_known": true, "service_version_known": true },
    "parser_info": {
      "type": "regex_based",
      "target_identifier_from": "target_ip",
      "target_field": "knowledge_base.targets",
      "patterns": [
        {
          "regex": "(\\d+)/(tcp|udp)\\s+(open|closed|filtered)\\s+(\\w+)\\s*(.*)$",
          "mapping": {
            "port": 1,
            "protocol": 2,
            "state": 3,
            "service": 4,
            "version": 5
          }
        }
      ]
    }
  },
  {
    "name": "gobuster_dir_command",
    "description": "웹사이트의 디렉토리 및 파일을 브루트포싱하여 찾습니다.",
    "base_block_type": "generic_shell_command",
    "command_template": "gobuster dir -u {target_url} -w {wordlist_path}",
    "preconditions": { "target_url_known": true, "wordlist_available": true },
    "effects": { "web_dirs_found": true },
    "parser_info": {
      "type": "regex_based",
      "target_field": "knowledge_base.known_facts",
      "patterns": [
        {
          "regex": "(/[^\\s]+)\\s+\\(Status:\\s*(\\d+)\\)\\s*\\[Size:\\s*(\\d+)\\]",
          "mapping": {
            "path": 1,
            "status_code": 2,
            "size": 3
          }
        }
      ]
    }
  },
  {
    "name": "whoami_command",
    "description": "현재 사용자를 확인합니다.",
    "command_template": "whoami",
    "preconditions": { "shell_access": true },
    "effects": { "user_identified": true },
    "parser_info": {
      "type": "rule_based",
      "target_field": "knowledge_base.known_facts"
    }
  }
]

